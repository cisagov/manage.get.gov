{% extends "domain_base.html" %}
{% load static field_helpers url_helpers %}

{% block title %}Prototype DNS | {{ domain.name }} | {% endblock %}

{% block domain_content %}

    {% include "includes/form_errors.html" with form=form %}

    <h1>Add DNS records</h1>

    <p>
    This is a prototype that demonstrates adding an 'A' record to a zone.
    Do note that this just adds records, but does not update or delete existing ones.
    </p>

    <div x-data="{ show_form: false }">
        <button
        class="usa-button"
        type="button"
        x-on:click="show_form = true"
        >
            Add record
        </button>
        <form 
            class="usa-form usa-form--large"
            method="post"
            novalidate id="form-container"
            x-cloak
            x-show="show_form"
        >
            {% csrf_token %}
            {% input_with_errors form.name %}
            {% input_with_errors form.content %}
            {% input_with_errors form.ttl %}
            <button
                    type="submit"
                    class="usa-button"
                >
                    Submit record
            </button>
            <button
                type="button"
                class="usa-button usa-button--outline"
                x-on:click="show_form = false"
            >
                Cancel
            </button>
        </form>
        
    </div>
    
    {% if dns_record %}
    <p>DNS RECORD: {{ dns_record }} </p>
    {% endif %}

    <table class="usa-table usa-table--borderless usa-table--stacked dotgov-table dotgov-table--stacked" id="dnsrecords-table">
        <caption class="sr-only">Your DNS records</caption>
        <thead>
            <tr>
              <th scope="col" role="columnheader">Type</th>
              <th scope="col" role="columnheader">Name</th>
              <th scope="col" role="columnheader">Content</th>
              <th scope="col" role="columnheader">TTL</th>
              <th scope="col" role="columnheader" class="width-0 padding-right-0">Action</th>
            </tr>
          </thead>
          <tbody>
            {% for dns_record in dns_records %}
                <tr id="dnsrecord-row_{{forloop.counter}}">
                    <td data-label="Type">
                        {{dns_record.type}}
                    </td>
                    <td data-label="Name">
                        {{dns_record.name}}
                    </td>
                    <td data-label="TTL">
                        {{dns_record.content}}
                    </td>
                    <td data-label="Type">
                        {{dns_record.ttl}}
                    </td>
                    <td class="padding-right-0" data-label="Action">
                        <div class="tablet:display-flex tablet:flex-row">
                            <button type="button" class='usa-button usa-button--unstyled margin-right-2 margin-top-0'>
                                <svg class="usa-icon" aria-hidden="true" focusable="false" role="img" width="24">
                                <use xlink:href="/public/img/sprite.svg#edit"></use>
                                </svg>
                                Edit <span class="usa-sr-only">{{ dns_record.type }} record for {{ dns_record.name }}</span>
                            </button>
                            <a 
                                role="button" 
                                id="button-trigger-delete-dnsrecord-{{ forloop.counter }}"
                                class="usa-button usa-button--unstyled text-underline margin-top-2 line-height-sans-5 text-secondary visible-mobile-flex"
                                >
                                <svg class="usa-icon" aria-hidden="true" focusable="false" role="img" width="24">
                                    <use xlink:href="/public/img/sprite.svg#delete"></use>
                                </svg>
                                Delete
                            </a>
        
                            <div class="usa-accordion usa-accordion--more-actions margin-right-2 hidden-mobile-flex">
                                <div class="usa-accordion__heading">
                                <button
                                    type="button"
                                    class="usa-button usa-button--unstyled usa-button--with-icon usa-accordion__button usa-button--more-actions margin-top-2px"
                                    aria-expanded="false"
                                    aria-controls="more-actions-dnsrecord-{{ forloop.counter }}"
                                    aria-label="More Actions for DNS record"
                                >
                                    <svg class="usa-icon" aria-hidden="true" focusable="false" role="img" width="24">
                                    <use xlink:href="/public/img/sprite.svg#more_vert"></use>
                                    </svg>
                                </button>
                                </div>
                                <div id="more-actions-dnsrecord-{{ forloop.counter }}" class="usa-accordion__content usa-prose shadow-1 left-auto right-neg-1" hidden>
                                <h2>More options</h2>
                                <button 
                                    type="button" 
                                    class="usa-button usa-button--unstyled text-underline late-loading-modal-trigger margin-top-2 line-height-sans-5 text-secondary"
                                    aria-label="Delete DNS record from Cloudflare"
                                >
                                    Delete
                                </button>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
            {% endfor %}
          </tbody>
    </table>
{% endblock %}  {# domain_content #}