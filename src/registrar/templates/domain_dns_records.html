{% extends "domain_base.html" %}
{% load static field_helpers url_helpers %}

{% block title %}Records | {{ domain.name }} | {% endblock %}

{% block breadcrumb %}
    {% include "includes/domain_breadcrumbs.html"%}
{% endblock breadcrumb %}

<!-- Form messages -->
{% block message_alerts %}
<div id="messages-container" hx-get="{% url 'get-messages' %}" hx-trigger="messagesRefresh from:body">
</div>
{% endblock message_alerts%}

{% block domain_content %}
    {% include "includes/form_errors.html" with form=form %}
    <div x-data="{ show_form: false, recordType: '' }">
        <div class="display-flex flex-align-center">
            <div class="grid-col">
                <h1>Records</h1>
            </div>
            
            <div class="grid-col-auto">
                <button
                    class="usa-button"
                    id="add-dnsrecord-button"
                    type="button"
                    x-on:click="show_form = true"
                >
                    Add record
                </button>
            </div>
        </div>
    
        <div class="grid-row">
            <div class="grid-col-12">
                <p class="measure-none">
                    Review, add and edit DNS records. Edits will go into effect once saved.
                </p>
                <p class="measure-none">
                    Click "Add record" and enter the values that you need to enter so everything and everyone can get the work done here.
                </p>

                <div x-cloak x-show="show_form">
                    {% include "includes/required_fields.html" %}
                
                    <section class="section-outlined section-outlined--extra-padding">
                    <!-- remove hx-swap none after and hide_clear form after submit -->
                    <form 
                        class="usa-form usa-form--extra-large"
                        hx-post="{% url 'domain-dns-records' domain.pk %}"
                        method="post"
                        _="on htmx:afterRequest trigger messageRefresh"
                        novalidate id="form-container"
                        x-cloak
                        x-ref="dnsForm"
                        x-show="show_form"
                    >
                        {% csrf_token %}
                        <h2>Add record</h2>

                        <div class="grid-row grid-gap">
                            <div class="grid-col-3">
                                {% input_with_errors form.type_field %}        
                            </div>
                        </div>

                        <div x-cloak x-show="recordType">
                            {% input_with_errors form.name %}    
                            <div class="grid-row grid-gap flex-align-end">
                                <div class="grid-col-9">
                                    {% input_with_errors form.content %}
                                </div>
                                <div class="grid-col-3">
                                    {% input_with_errors form.ttl %}        
                                </div>
                            </div>
                        
                            {% input_with_errors form.comment %}

                            <button
                                type="reset"
                                class="usa-button usa-button--outline"
                                x-on:click="show_form = false"
                            >
                                Cancel
                            </button>
                            <button
                                    class="usa-button"
                                >
                                    Save
                            </button>
                        </div>
                    </form>
                    </section>
                </div>
             </div>
        </div>
    </div>
<!-- 
    <table class="usa-table usa-table--borderless usa-table--stacked dotgov-table dotgov-table--stacked" id="dnsrecords-table">
        <caption class="sr-only">Your DNS records</caption>
        <thead>
            <tr>
            <th scope="col" role="columnheader">Type</th>
            <th scope="col" role="columnheader">Name</th>
            <th scope="col" role="columnheader">Content</th>
            <th scope="col" role="columnheader">TTL</th>
            <th scope="col" role="columnheader" class="width-0 padding-right-0">Action</th>
            </tr>
        </thead>
        <tbody id="dns-records-table">
            {% for dns_record in dns_records %}
                {% include "domain_dns_record_row.html" with counter=forloop.counter dns_record=dns_record %}
            {% endfor %}
        </tbody>
    </table> -->
    
    <!-- {% if dns_records %} -->
        <!-- <div hx-get="{% url 'get-dns-records-for-domain-json' domain.pk %}" hx-trigger="create-dns-record from:body"> -->
            {% include "domain_dns_records_table.html" %}
        <!-- </div> -->
    <!-- {% endif %} -->
{% endblock %}  {# domain_content #}